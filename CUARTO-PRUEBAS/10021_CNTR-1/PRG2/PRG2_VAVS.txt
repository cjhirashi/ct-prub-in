REM PRG2_VAVS (CONTROL: CUARTO CONTROL 1)
REM CONTROL DE VAVS DEL SISTEMA
REM AUTHOR CARLOS JIMENEZ HIRASHI @cjhirashi
REM VERSION 1.0.0

REM DECLARACION DE VARIABLES DEL SISTEMA

	LOCALS P_APER, SINC, DEMANDA, VAV, CM_BL, ACTIV

	P_APER = 5
	SINC = 10

REM LOGICA DE CONTROL

	REM *PLENUM 1

		REM **VAV 01 - MEDIANA 
			DEMANDA = AV85

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO1 = VAV
				BO14 = CM_BL

		REM **VAV 02 - GRANDE
			DEMANDA = AV86

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO2 = VAV
				BO15 = CM_BL

		REM **VAV 03 - CHICA
			DEMANDA = AV67
		
			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0
		
			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0
		
			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO21 = VAV
				BO22 = CM_BL
		
	REM *PLENUM 2

		REM **VAV 01 - MEDIANA
			DEMANDA = AV87

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO3 = VAV
				BO16 = CM_BL

		REM **VAV 02 - GRANDE
			DEMANDA = AV88

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO4 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO1 = CM_BL
				ENDIF

	REM *PLENUM 3

		REM **VAV 01 - GRANDE
			DEMANDA = AV68
		
			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0
		
			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0
		
			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO23 = VAV
				BO24 = CM_BL
		
	REM *PLENUM 4

		REM **VAV 01 - MEDIANA
			DEMANDA = AV89

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO5 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO2 = CM_BL
				ENDIF

		REM **VAV 02 - GRANDE
			DEMANDA = AV90

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO6 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO3 = CM_BL
				ENDIF

		REM **VAV 03 - CHICA
			DEMANDA = AV91

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO7 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO4 = CM_BL
				ENDIF

	REM *PLENUM 5

		REM **VAV 01 - CHICA
			DEMANDA = AV92

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO8 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO5 = CM_BL
				ENDIF

		REM **VAV 02 - GRANDE
			DEMANDA = AV93

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO9 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO6 = CM_BL
				ENDIF

	REM *PLENUM 6

		REM **VAV 01 - GRANDE
			DEMANDA = AV94

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO10 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO7 = CM_BL
				ENDIF

		REM **VAV 02 - MEDIANA
			DEMANDA = AV95

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO11 = VAV
				IF INTERVAL(SINC) THEN
					10022.BO8 = CM_BL
				ENDIF

	REM *PLENUM R7

		REM **VAV 01 - CHICA
			DEMANDA = AV96

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO12 = VAV
				BO17 = CM_BL

		REM **VAV 02 - GRANDE
			DEMANDA = AV97

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO13 = VAV
				BO18 = CM_BL

END