REM PRG2_VAVS (CONTROL: CUARTO CONTROL 1)
REM CONTROL DE VAVS DEL SISTEMA
REM AUTHOR CARLOS JIMENEZ HIRASHI @cjhirashi
REM VERSION 1.0.0

REM DECLARACION DE VARIABLES

	LOCALS P_APER, SINC, DEMANDA, VAV, CM_BL, ACTIV

REM VARIABLES DE ENTRADA

	P_APER = 5
	SINC = 10

REM CONTROL DE CAJAS VAV

	REM *PLENUM 1

		REM **VAV 01 - MEDIANA 
			DEMANDA = AV85

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO1 = VAV
				BO14 = CM_BL

		REM **VAV 02 - GRANDE
			DEMANDA = AV86

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV = 1
				IF DEMANDA < 1 THEN ACTIV = 0

			REM ***CONTROL DE COMPUERTAS
				IF ACTIV THEN VAV = DEMANDA , CM_BL = 1 ELSE VAV = 0 , CM_BL = 0

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO2 = VAV
				BO15 = CM_BL

	REM *PLENUM 2

		REM **VAV 01 - MEDIANA
			LOCALS ACTIV3
			DEMANDA = AV87		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV3 = 1
				IF DEMANDA < 1 THEN ACTIV3 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV3) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO3 = VAV			: REM COMPUERTA DE VAV
				BO16 = CM_BL		: REM COMPUERTA DE BLOQUEO

		REM **VAV 02 - GRANDE
			LOCALS ACTIV4
			DEMANDA = AV88		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV4 = 1
				IF DEMANDA < 1 THEN ACTIV4 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV4) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO4 = VAV				: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO1 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

	REM *PLENUM 4

		REM **VAV 01 - MEDIANA
			LOCALS ACTIV5
			DEMANDA = AV89		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV5 = 1
				IF DEMANDA < 1 THEN ACTIV5 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV5) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO5 = VAV				: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO2 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

		REM **VAV 02 - GRANDE
			LOCALS ACTIV6
			DEMANDA = AV90		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV6 = 1
				IF DEMANDA < 1 THEN ACTIV6 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV6) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO6 = VAV				: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO3 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

		REM **VAV 03 - CHICA
			LOCALS ACTIV7
			DEMANDA = AV91		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV7 = 1
				IF DEMANDA < 1 THEN ACTIV7 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV7) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO7 = VAV				: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO4 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

	REM *PLENUM 5

		REM **VAV 01 - CHICA
			LOCALS ACTIV8
			DEMANDA = AV92		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV8 = 1
				IF DEMANDA < 1 THEN ACTIV8 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV8) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO8 = VAV				: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO5 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

		REM **VAV 02 - GRANDE
			LOCALS ACTIV9
			DEMANDA = AV93		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV9 = 1
				IF DEMANDA < 1 THEN ACTIV9 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV9) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO9 = VAV			: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO6 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

	REM *PLENUM 6

		REM **VAV 01 - GRANDE
			LOCALS ACTIV10
			DEMANDA = AV94		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV10 = 1
				IF DEMANDA < 1 THEN ACTIV10 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV10) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO10 = VAV			: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO7 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

		REM **VAV 02 - MEDIANA
			LOCALS ACTIV11
			DEMANDA = AV95		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV11 = 1
				IF DEMANDA < 1 THEN ACTIV11 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV11) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO11 = VAV			: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO8 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

	REM *PLENUM R7

		REM **VAV 01 - CHICA
			LOCALS ACTIV12
			DEMANDA = AV96		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV12 = 1
				IF DEMANDA < 1 THEN ACTIV12 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV12) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO12 = VAV			: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO9 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

		REM **VAV 02 - GRANDE
			LOCALS ACTIV13
			DEMANDA = AV97		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV13 = 1
				IF DEMANDA < 1 THEN ACTIV13 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV13) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO13 = VAV			: REM COMPUERTA DE VAV
				IF INTERVAL(SINC) THEN
					10022.BO10 = CM_BL	: REM COMPUERTA DE BLOQUEO
				ENDIF

END