REM PRG2_VAVS (CONTROL: CUARTO CONTROL 2)
REM CONTROL DE VAVS DEL SISTEMA
REM AUTHOR CARLOS JIMENEZ HIRASHI @cjhirashi
REM VERSION 1.0.0

REM DECLARACION DE VARIABLES

	LOCALS DEMANDA, VAV, CM_BL, P_APER, SINC

REM VARIABLES DE ENTRADA
		
	P_APER = 5			: REM PORCENTAJE DE DEMANDA PARA ACTIVACION
	SINC = 5			: REM TIEMPO DE SINCRONIZACION DE DATOS

REM CONTROL DE CAJAS VAV

	REM *PLENUM 1

		REM **VAV 03 - CHICA
			LOCALS ACTIV1
			DEMANDA = AV14		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV1 = 1
				IF DEMANDA < 1 THEN ACTIV1 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV1) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO13 = VAV			: REM COMPUERTA DE VAV
				BO14 = CM_BL		: REM COMPUERTA DE BLOQUEO

	REM *PLENUM 3

		REM **VAV 01- GRANDE
			LOCALS ACTIV2
			DEMANDA = AV15		: REM DEMANDA DE ENTRADA DE VAV

			REM ***ACTIVACION DE CAJA
				IF DEMANDA > P_APER THEN ACTIV2 = 1
				IF DEMANDA < 1 THEN ACTIV2 = 0

			REM ***CONTROL DE COMPUERTAS
				IF TIMEOFF(ACTIV2) THEN CM_BL = 0, VAV = 0 ELSE CM_BL = 1, VAV = DEMANDA

			REM ***ASIGNACION DE PUNTOS DE CONTROL COMPUERTAS
				AO15 = VAV			: REM COMPUERTA DE VAV
				BO16 = CM_BL		: REM COMPUERTA DE BLOQUEO

END