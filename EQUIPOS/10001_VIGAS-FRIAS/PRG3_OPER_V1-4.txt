REM PRG3_OPER_V1-4 (CONTROL: VIGAS FRIAS)
REM OPERACION DE VIGAS FRIAS CON VALVULAS ON/OFF
REM AUTHOR CARLOS JIMENEZ HIRASHI @cjhirashi
REM VERSION 1.0.0

REM DECLARACION DE VARIABLES

    LOCALS TM1, TM2, TM3, TM4		: REM (LECTURA) TEMPERATURAS DE AREAS
    LOCALS SP1, SP2, SP3, SP4		: REM (LECTURA) SETPOINTS DE TEMPERATURAS DE AREA
    LOCALS CCV1, CCV2, CCV3, CCV4	: REM (ESCRITURA) CONTROL VALVULAS AGUA FRIA
    LOCALS HCV1, HCV2, HCV3, HCV4	: REM (ESCRITURA) CONTROL VALVULAS AGUA CALIENTE
    LOCALS BM1, BM2, OCC			: REM (VAR IN) VARIABLES DEL SISTEMA

REM VARIABLES DE ENTRADA

    TM1 = AV1	: REM TEMPERATURA DE SALA DE JUNTAS
    IF BV39 = 0 THEN SP1 = AV2 ELSE SP1 = AV47
    TM2 = AV3	: REM TEMPERATURA DE OF ING JORGE
    IF BV36 = 0 THEN SP2 = AV4 ELSE SP2 = AV44
    TM3 = AV5	: REM TEMPERATURA ENTRADA AREA COMUN
    IF BV38 = 0 THEN SP3 = AV6 ELSE SP3 = AV46
    TM4 = AV7	: REM TEMPERATURA AREA COMUN FRENTE OF ING LUIS
    IF BV38 = 0 THEN SP4 = AV8 ELSE SP4 = AV46
    OCC = BV1	: REM ACTIVACION DEL SISTEMA POR ESTADO DE LA UMA1

    BM1 = 1
    BM2 = 0

REM CONTROL DE TEMPERATURA DE VIGAS FRIAS

    REM *CONTROL DE VIGA FRIA ZONA 1 (SALA DE JUNTAS)
	    IF TM1 > 80 OR OCC = 0 THEN CCV1 = 0 , HCV1 = 0 , GOTO SISTEMA1
        REM **CONTROL DE ENFRIAMIENTO
	        IF TM1 > SP1 + BM1 THEN CCV1 = 1
	        IF TM1 < SP1 + BM2 THEN CCV1 = 0
        REM **CONTROL DE CALEFACCION
	        IF TM1 < SP1 - BM1 THEN HCV1 = 1
	        IF TM1 > SP1 - BM2 THEN HCV1 = 0
        SISTEMA1:

    REM *CONTROL DE VIGA FRIA ZONA 2 (OFICINA 04 - ING JORGE)
	    IF TM2 > 80 OR OCC = 0 THEN CCV2 = 0 , HCV2 = 0 , GOTO SISTEMA2
        REM **CONTROL DE ENFRIAMIENTO
	        IF TM2 > SP2 + BM1 THEN CCV2 = 1
	        IF TM2 < SP2 + BM2 THEN CCV2 = 0
        REM **CONTROL DE CALEFACCION
	        IF TM2 < SP2 - BM1 THEN HCV2 = 1
	        IF TM2 > SP2 - BM2 THEN HCV2 = 0
        SISTEMA2:

    REM *CONTROL DE VIGA FRIA ZONA 3
	    IF TM3 > 80 OR OCC = 0 THEN CCV3 = 0 , HCV3 = 0 , GOTO SISTEMA3
        REM **CONTROL DE ENFRIAMIENTO
	        IF TM3 > SP3 + BM1 THEN CCV3 = 1
	        IF TM3 < SP3 + BM2 THEN CCV3 = 0
        REM **CONTROL DE CALEFACCION
	        IF TM3 < SP3 - BM1 THEN HCV3 = 1
	        IF TM3 > SP3 - BM2 THEN HCV3 = 0
        SISTEMA3:

    REM *CONTROL DE VIGA FRIA ZONA 4
	    IF TM4 > 80 OR OCC = 0 THEN CCV4 = 0 , HCV4 = 0 , GOTO SISTEMA4
        REM **CONTROL DE ENFRIAMIENTO
	        IF TM4 > SP4 + BM1 THEN CCV4 = 1
	        IF TM4 < SP4 + BM2 THEN CCV4 = 0
        REM **CONTROL DE CALEFACCION
	        IF TM4 < SP4 - BM1 THEN HCV4 = 1
	        IF TM4 > SP4 - BM2 THEN HCV4 = 0
        SISTEMA4:

REM VARIABLES DE SALIDA

    BO1 = CCV1 : REM SALA DE JUNTAS
    BO2 = HCV1 : REM SALA DE JUNTAS
    BO3 = CCV2 : REM OFICINA JORGE
    BO4 = HCV2 : REM OFICINA JORGE
    BO5 = CCV3 : REM AREA COMUN ENTRADA
    BO6 = HCV3 : REM AREA COMUN ENTRADA
    BO7 = CCV4 : REM AREA COMUN ENTRADA L INNES
    BO8 = HCV4 : REM AREA COMUN ENTRADA L INNES

END